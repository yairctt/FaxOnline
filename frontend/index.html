<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FAX Compiler â€” IDE Online</title>
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;600;700;800&display=swap"
    rel="stylesheet" />
  <style>
    /* â”€â”€â”€ RESET & VARIABLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg: #0d0f14;
      --bg2: #13161e;
      --bg3: #1a1e2a;
      --panel: #161b26;
      --border: #252c3e;
      --border2: #2e3650;
      --accent: #5b8af5;
      --accent2: #7c5bf5;
      --green: #3ecf8e;
      --red: #f56565;
      --yellow: #f5c842;
      --orange: #f5824b;
      --text: #c9d1e8;
      --text2: #7889b0;
      --text3: #3d4f72;
      --glow: rgba(91, 138, 245, 0.15);
      --glow-green: rgba(62, 207, 142, 0.1);
      --glow-red: rgba(245, 101, 101, 0.1);
      --radius: 8px;
      --font-mono: 'JetBrains Mono', monospace;
      --font-ui: 'Syne', sans-serif;
    }

    html,
    body {
      height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-ui);
      overflow: hidden;
    }

    /* â”€â”€â”€ NOISE OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 999;
      opacity: .4;
    }

    /* â”€â”€â”€ LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .app {
      display: grid;
      grid-template-rows: 52px 1fr;
      grid-template-columns: 1fr 1fr;
      height: 100vh;
      gap: 0;
    }

    /* â”€â”€â”€ TOPBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .topbar {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      padding: 0 20px;
      background: var(--bg2);
      border-bottom: 1px solid var(--border);
      gap: 16px;
      position: relative;
      z-index: 10;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 18px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }

    .logo-icon {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      color: #fff;
      font-weight: 700;
      box-shadow: 0 0 12px rgba(91, 138, 245, .4);
    }

    .logo-text span {
      color: var(--accent);
    }

    .topbar-divider {
      width: 1px;
      height: 22px;
      background: var(--border);
      margin: 0 4px;
    }

    .btn-run {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 7px 18px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border: none;
      border-radius: var(--radius);
      color: #fff;
      font-family: var(--font-ui);
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.3px;
      box-shadow: 0 0 20px rgba(91, 138, 245, .35);
      transition: all .2s;
      position: relative;
      overflow: hidden;
    }

    .btn-run:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 24px rgba(91, 138, 245, .5);
    }

    .btn-run:active {
      transform: translateY(0);
    }

    .btn-run::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, rgba(255, 255, 255, .08), transparent);
    }

    .btn-run .run-icon {
      font-size: 14px;
    }

    .btn-run.loading {
      opacity: .7;
      pointer-events: none;
    }

    .btn-clear {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 7px 14px;
      background: transparent;
      border: 1px solid var(--border2);
      border-radius: var(--radius);
      color: var(--text2);
      font-family: var(--font-ui);
      font-size: 13px;
      cursor: pointer;
      transition: all .2s;
    }

    .btn-clear:hover {
      border-color: var(--accent);
      color: var(--text);
    }

    .status-pill {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-family: var(--font-mono);
      color: var(--text2);
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--text3);
      transition: background .3s, box-shadow .3s;
    }

    .status-dot.ok {
      background: var(--green);
      box-shadow: 0 0 6px var(--green);
    }

    .status-dot.error {
      background: var(--red);
      box-shadow: 0 0 6px var(--red);
    }

    .status-dot.running {
      background: var(--yellow);
      box-shadow: 0 0 6px var(--yellow);
      animation: pulse 1s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: .4;
      }
    }

    .backend-badge {
      font-size: 11px;
      font-family: var(--font-mono);
      padding: 3px 8px;
      border-radius: 20px;
      background: var(--bg3);
      border: 1px solid var(--border);
      color: var(--text3);
    }

    .backend-badge.online {
      color: var(--green);
      border-color: rgba(62, 207, 142, .3);
    }

    .backend-badge.offline {
      color: var(--red);
      border-color: rgba(245, 101, 101, .3);
    }

    /* â”€â”€â”€ EDITOR PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .editor-panel,
    .output-panel {
      display: flex;
      flex-direction: column;
      overflow: hidden;
      background: var(--panel);
    }

    .editor-panel {
      border-right: 1px solid var(--border);
    }

    .panel-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 16px;
      height: 38px;
      background: var(--bg2);
      border-bottom: 1px solid var(--border);
      font-size: 12px;
      color: var(--text2);
      font-family: var(--font-mono);
      flex-shrink: 0;
    }

    .panel-header .file-tab {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0 12px;
      height: 38px;
      margin: 0 -16px;
      border-right: 1px solid var(--border);
      color: var(--text);
      font-size: 12px;
    }

    .file-tab .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
    }

    .panel-header .spacer {
      flex: 1;
    }

    .panel-header .hint {
      font-size: 11px;
      color: var(--text3);
    }

    /* â”€â”€â”€ EDITOR AREA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .editor-wrapper {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    .line-numbers {
      padding: 16px 0 16px 8px;
      min-width: 44px;
      background: var(--bg2);
      border-right: 1px solid var(--border);
      text-align: right;
      font-family: var(--font-mono);
      font-size: 13px;
      line-height: 22px;
      color: var(--text3);
      user-select: none;
      overflow: hidden;
      flex-shrink: 0;
    }

    .line-numbers span {
      display: block;
      padding-right: 10px;
    }

    #code-input {
      flex: 1;
      padding: 16px;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text);
      font-family: var(--font-mono);
      font-size: 13px;
      line-height: 22px;
      resize: none;
      tab-size: 2;
      caret-color: var(--accent);
    }

    #code-input::selection {
      background: rgba(91, 138, 245, .25);
    }

    #code-input::placeholder {
      color: var(--text3);
    }

    /* â”€â”€â”€ OUTPUT PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .output-tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      background: var(--bg2);
      flex-shrink: 0;
    }

    .output-tab {
      padding: 0 16px;
      height: 38px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      font-family: var(--font-mono);
      color: var(--text3);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all .2s;
    }

    .output-tab:hover {
      color: var(--text2);
    }

    .output-tab.active {
      color: var(--text);
      border-bottom-color: var(--accent);
    }

    .tab-badge {
      font-size: 10px;
      padding: 1px 6px;
      border-radius: 10px;
      background: var(--bg3);
      color: var(--text3);
    }

    .output-tab.active .tab-badge {
      background: rgba(91, 138, 245, .2);
      color: var(--accent);
    }

    .tab-badge.has-errors {
      background: rgba(245, 101, 101, .15);
      color: var(--red);
    }

    .output-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .output-content::-webkit-scrollbar {
      width: 6px;
    }

    .output-content::-webkit-scrollbar-track {
      background: transparent;
    }

    .output-content::-webkit-scrollbar-thumb {
      background: var(--border2);
      border-radius: 3px;
    }

    /* â”€â”€â”€ TAB PANELS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: block;
    }

    /* â”€â”€â”€ WELCOME / EMPTY STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .empty-state {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      color: var(--text3);
      text-align: center;
    }

    .empty-icon {
      font-size: 32px;
      opacity: .5;
    }

    .empty-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text2);
    }

    .empty-sub {
      font-size: 12px;
      font-family: var(--font-mono);
      line-height: 1.6;
    }

    /* â”€â”€â”€ SUCCESS RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .result-success {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .success-banner {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: rgba(62, 207, 142, .08);
      border: 1px solid rgba(62, 207, 142, .2);
      border-radius: var(--radius);
    }

    .success-icon {
      font-size: 22px;
    }

    .success-text {
      font-size: 14px;
      font-weight: 600;
      color: var(--green);
    }

    .success-sub {
      font-size: 12px;
      color: var(--text2);
      margin-top: 2px;
      font-family: var(--font-mono);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    .stat-card {
      padding: 12px 14px;
      background: var(--bg3);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      text-align: center;
    }

    .stat-value {
      font-size: 22px;
      font-weight: 800;
      color: var(--accent);
      font-family: var(--font-mono);
    }

    .stat-label {
      font-size: 10px;
      color: var(--text3);
      margin-top: 2px;
      text-transform: uppercase;
      letter-spacing: .5px;
    }

    /* â”€â”€â”€ ERROR RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .result-errors {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .error-summary {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: rgba(245, 101, 101, .08);
      border: 1px solid rgba(245, 101, 101, .2);
      border-radius: var(--radius);
      margin-bottom: 4px;
    }

    .error-summary-icon {
      font-size: 20px;
    }

    .error-summary-text {
      font-size: 14px;
      font-weight: 600;
      color: var(--red);
    }

    .error-summary-sub {
      font-size: 12px;
      color: var(--text2);
      margin-top: 2px;
      font-family: var(--font-mono);
    }

    .error-card {
      padding: 12px 14px;
      background: var(--bg3);
      border: 1px solid var(--border);
      border-left: 3px solid var(--red);
      border-radius: var(--radius);
      cursor: pointer;
      transition: background .15s, border-color .15s;
      animation: slideIn .2s ease both;
    }

    .error-card:hover {
      background: var(--bg2);
      border-color: var(--border2);
      border-left-color: var(--red);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .error-card.lex {
      border-left-color: var(--orange);
    }

    .error-card.syn {
      border-left-color: var(--yellow);
    }

    .error-card.sem {
      border-left-color: var(--red);
    }

    .error-top {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .error-type-badge {
      font-size: 9px;
      font-weight: 700;
      padding: 2px 7px;
      border-radius: 10px;
      text-transform: uppercase;
      letter-spacing: .5px;
      font-family: var(--font-mono);
    }

    .badge-lex {
      background: rgba(245, 130, 75, .15);
      color: var(--orange);
    }

    .badge-syn {
      background: rgba(245, 200, 66, .15);
      color: var(--yellow);
    }

    .badge-sem {
      background: rgba(245, 101, 101, .15);
      color: var(--red);
    }

    .badge-unk {
      background: rgba(91, 138, 245, .15);
      color: var(--accent);
    }

    .error-location {
      font-size: 11px;
      color: var(--text3);
      font-family: var(--font-mono);
    }

    .error-token {
      font-size: 12px;
      color: var(--accent);
      font-family: var(--font-mono);
      background: rgba(91, 138, 245, .1);
      padding: 1px 6px;
      border-radius: 4px;
    }

    .error-msg {
      font-size: 12px;
      color: var(--text2);
      font-family: var(--font-mono);
      line-height: 1.5;
    }

    /* â”€â”€â”€ RAW OUTPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .raw-output {
      font-family: var(--font-mono);
      font-size: 12px;
      line-height: 1.8;
      color: var(--text2);
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* â”€â”€â”€ SYMBOLS TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .symbols-note {
      font-size: 12px;
      color: var(--text3);
      font-family: var(--font-mono);
      line-height: 1.7;
      text-align: center;
      padding: 32px 16px;
    }

    /* â”€â”€â”€ CONNECTION OVERLAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #conn-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(13, 15, 20, .85);
      backdrop-filter: blur(4px);
      z-index: 100;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      text-align: center;
    }

    #conn-overlay.show {
      display: flex;
    }

    .conn-icon {
      font-size: 40px;
    }

    .conn-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }

    .conn-sub {
      font-size: 13px;
      color: var(--text2);
      max-width: 420px;
      font-family: var(--font-mono);
      line-height: 1.7;
    }

    .conn-url {
      font-family: var(--font-mono);
      font-size: 13px;
      color: var(--accent);
      background: var(--bg3);
      padding: 8px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border2);
    }

    .btn-dismiss {
      padding: 8px 20px;
      background: transparent;
      border: 1px solid var(--border2);
      border-radius: var(--radius);
      color: var(--text2);
      font-family: var(--font-ui);
      font-size: 13px;
      cursor: pointer;
      transition: all .2s;
      margin-top: 4px;
    }

    .btn-dismiss:hover {
      border-color: var(--accent);
      color: var(--text);
    }

    /* â”€â”€â”€ SCROLLBAR GLOBAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border2);
      border-radius: 3px;
    }

    /* â”€â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 768px) {
      .app {
        grid-template-columns: 1fr;
        grid-template-rows: 52px 50vh 1fr;
      }

      .editor-panel {
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
    }
  </style>
</head>

<body>

  <!-- Connection Warning Overlay -->
  <div id="conn-overlay">
    <div class="conn-icon">ğŸ”Œ</div>
    <div class="conn-title">Backend no disponible</div>
    <div class="conn-sub">
      El servidor Java no estÃ¡ corriendo.<br>
    </div>
    <button class="btn-dismiss" onclick="dismissOverlay()">Entendido</button>
  </div>

  <div class="app">

    <!-- â”€â”€ TOPBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <header class="topbar">
      <div class="logo">
        <div class="logo-icon">F</div>
        <span class="logo-text">F<span>AX</span> Compiler</span>
      </div>
      <div class="topbar-divider"></div>

      <button class="btn-run" id="btn-run" onclick="compilar()">
        <span class="run-icon">â–¶</span> Compilar
      </button>
      <button class="btn-clear" onclick="limpiar()">âœ• Limpiar</button>

      <div class="topbar-divider"></div>
      <span id="backend-badge" class="backend-badge">â— backend</span>

      <div class="status-pill">
        <div class="status-dot" id="status-dot"></div>
        <span id="status-text">listo</span>
      </div>
    </header>

    <!-- â”€â”€ EDITOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <section class="editor-panel">
      <div class="panel-header">
        <div class="file-tab">
          <div class="dot"></div>
          programa.fax
        </div>
        <div class="spacer"></div>
        <span class="hint" id="editor-hint">Ctrl+Enter para compilar</span>
      </div>
      <div class="editor-wrapper">
        <div class="line-numbers" id="line-numbers">
          <span>1</span>
        </div>
        <textarea id="code-input" spellcheck="false"
          placeholder="// Escribe tu cÃ³digo FAX aquÃ­&#10;// Ejemplo:&#10;inicio&#10;  entero x = 5;&#10;  escribir(x);&#10;fin"></textarea>
      </div>
    </section>

    <!-- â”€â”€ OUTPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <section class="output-panel">
      <div class="output-tabs">
        <div class="output-tab active" id="tab-resultado" onclick="switchTab('resultado')">
          Resultado <span class="tab-badge" id="badge-resultado">â€”</span>
        </div>
        <div class="output-tab" id="tab-errores" onclick="switchTab('errores')">
          Errores <span class="tab-badge" id="badge-errores">0</span>
        </div>
        <div class="output-tab" id="tab-raw" onclick="switchTab('raw')">
          Salida Raw
        </div>
      </div>
      <div class="output-content">

        <!-- Tab: Resultado -->
        <div class="tab-panel active" id="panel-resultado">
          <div class="empty-state" id="empty-resultado">
            <div class="empty-icon"></div>
            <div class="empty-title">Sin resultados aÃºn</div>
            <div class="empty-sub">
              Escribe cÃ³digo FAX en el editor<br>y presiona <strong>Compilar</strong>
            </div>
          </div>
          <div id="result-content" style="display:none"></div>
        </div>

        <!-- Tab: Errores -->
        <div class="tab-panel" id="panel-errores">
          <div class="empty-state" id="empty-errores">
            <div class="empty-icon"></div>
            <div class="empty-title">Sin errores</div>
            <div class="empty-sub">Los errores de compilaciÃ³n<br>aparecerÃ¡n aquÃ­</div>
          </div>
          <div class="result-errors" id="errors-list" style="display:none"></div>
        </div>

        <!-- Tab: Raw -->
        <div class="tab-panel" id="panel-raw">
          <div class="empty-state" id="empty-raw">
            <div class="empty-icon"></div>
            <div class="empty-title">Sin salida</div>
            <div class="empty-sub">La salida completa del compilador<br>aparecerÃ¡ aquÃ­</div>
          </div>
          <pre class="raw-output" id="raw-output" style="display:none"></pre>
        </div>

      </div>
    </section>
  </div>

  <script>
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  CONFIG
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const BACKEND_URL = 'https://fax-backend-production-6527.up.railway.app/compilar';

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  STATE
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let activeTab = 'resultado';
    let lastErrorCount = 0;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  LINE NUMBERS
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const textarea = document.getElementById('code-input');
    const lineNumbers = document.getElementById('line-numbers');

    function updateLineNumbers() {
      const lines = textarea.value.split('\n').length;
      let html = '';
      for (let i = 1; i <= lines; i++) html += `<span>${i}</span>`;
      lineNumbers.innerHTML = html;
      lineNumbers.scrollTop = textarea.scrollTop;
    }

    textarea.addEventListener('input', updateLineNumbers);
    textarea.addEventListener('scroll', () => { lineNumbers.scrollTop = textarea.scrollTop; });

    // Tab key â†’ indent
    textarea.addEventListener('keydown', e => {
      if (e.key === 'Tab') {
        e.preventDefault();
        const s = textarea.selectionStart;
        const v = textarea.value;
        textarea.value = v.substring(0, s) + '  ' + v.substring(textarea.selectionEnd);
        textarea.selectionStart = textarea.selectionEnd = s + 2;
        updateLineNumbers();
      }
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        e.preventDefault();
        compilar();
      }
    });

    updateLineNumbers();

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  TAB SWITCHING
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function switchTab(name) {
      document.querySelectorAll('.output-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
      document.getElementById('tab-' + name).classList.add('active');
      document.getElementById('panel-' + name).classList.add('active');
      activeTab = name;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  STATUS HELPERS
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setStatus(state, text) {
      const dot = document.getElementById('status-dot');
      const txt = document.getElementById('status-text');
      dot.className = 'status-dot ' + state;
      txt.textContent = text;
    }

    function setBadge(id, text, hasErrors) {
      const el = document.getElementById(id);
      el.textContent = text;
      el.className = 'tab-badge' + (hasErrors ? ' has-errors' : '');
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  BACKEND PING
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function checkBackend() {
      const badge = document.getElementById('backend-badge');
      try {
        const r = await fetch('https://fax-backend-production-6527.up.railway.app/ping', { method: 'GET', signal: AbortSignal.timeout(5000) });
        if (r.ok) {
          badge.textContent = 'â— online';
          badge.className = 'backend-badge online';
          return true;
        }
      } catch (_) { }
      badge.textContent = 'â— offline';
      badge.className = 'backend-badge offline';
      return false;
    }

    checkBackend();
    setInterval(checkBackend, 10000);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  LIMPIAR
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function limpiar() {
      textarea.value = '';
      updateLineNumbers();
      // Reset outputs
      showEmpty('resultado');
      showEmpty('errores');
      showEmpty('raw');
      setBadge('badge-resultado', 'â€”', false);
      setBadge('badge-errores', '0', false);
      document.getElementById('raw-output').style.display = 'none';
      setStatus('', 'listo');
      textarea.focus();
    }

    function showEmpty(tab) {
      document.getElementById('empty-' + tab).style.display = '';
      if (tab === 'resultado') document.getElementById('result-content').style.display = 'none';
      if (tab === 'errores') document.getElementById('errors-list').style.display = 'none';
      if (tab === 'raw') document.getElementById('raw-output').style.display = 'none';
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  PARSE COMPILER OUTPUT
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function parseOutput(raw) {
      const exitoso = raw.includes('âœ“') || raw.includes('Compilacion exitosa') || raw.includes('exitosa');
      const errLines = raw.split('\n').filter(l => l.match(/LÃ­nea \d+, Columna \d+:/i));

      const errors = errLines.map(line => {
        // "LÃ­nea 3, Columna 5: ERROR_SEMÃNTICO 'x' - Variable no declarada"
        const m = line.match(/LÃ­nea\s+(\d+),\s*Columna\s+(\d+):\s*([\w_]+)\s+('.*?')?\s*[-â€“]?\s*(.*)/i);
        if (!m) return { line: 0, col: 0, type: 'UNKNOWN', token: '', msg: line.trim() };
        return {
          line: parseInt(m[1]),
          col: parseInt(m[2]),
          type: m[3] || 'UNKNOWN',
          token: m[4] ? m[4].replace(/'/g, '') : '',
          msg: m[5] ? m[5].trim() : ''
        };
      });

      // Count by type
      const totalErrors = errors.length;
      const lexico = errors.filter(e => e.type.includes('LÃ‰XICO') || e.type.includes('LEXICO')).length;
      const sintactico = errors.filter(e => e.type.includes('SINT') || e.type.includes('SINT')).length;
      const semantico = errors.filter(e => e.type.includes('SEMÃ') || e.type.includes('SEMA')).length;

      return { exitoso, errors, totalErrors, lexico, sintactico, semantico };
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  RENDER RESULTS
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderResults(raw) {
      const { exitoso, errors, totalErrors, lexico, sintactico, semantico } = parseOutput(raw);

      // â”€â”€ Raw tab â”€â”€
      const rawEl = document.getElementById('raw-output');
      rawEl.textContent = raw;
      rawEl.style.display = 'block';
      document.getElementById('empty-raw').style.display = 'none';

      // â”€â”€ Resultado tab â”€â”€
      const resultContent = document.getElementById('result-content');
      const emptyResult = document.getElementById('empty-resultado');
      emptyResult.style.display = 'none';
      resultContent.style.display = 'block';

      if (exitoso) {
        resultContent.innerHTML = `
      <div class="result-success">
        <div class="success-banner">
          <span class="success-icon">âœ…</span>
          <div>
            <div class="success-text">CompilaciÃ³n Exitosa</div>
            <div class="success-sub">No se encontraron errores lÃ©xicos, sintÃ¡cticos ni semÃ¡nticos</div>
          </div>
        </div>
        <div class="stats-grid">
          <div class="stat-card"><div class="stat-value">0</div><div class="stat-label">LÃ©xicos</div></div>
          <div class="stat-card"><div class="stat-value">0</div><div class="stat-label">SintÃ¡cticos</div></div>
          <div class="stat-card"><div class="stat-value">0</div><div class="stat-label">SemÃ¡nticos</div></div>
        </div>
      </div>`;
        setBadge('badge-resultado', 'âœ“', false);
        setBadge('badge-errores', '0', false);
        setStatus('ok', 'sin errores');
      } else {
        resultContent.innerHTML = `
      <div class="result-errors">
        <div class="error-summary">
          <span class="error-summary-icon">â›”</span>
          <div>
            <div class="error-summary-text">${totalErrors} error${totalErrors !== 1 ? 'es' : ''} encontrado${totalErrors !== 1 ? 's' : ''}</div>
            <div class="error-summary-sub">Revisa la pestaÃ±a <strong>Errores</strong> para mÃ¡s detalle</div>
          </div>
        </div>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" style="color:var(--orange)">${lexico}</div>
            <div class="stat-label">LÃ©xicos</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" style="color:var(--yellow)">${sintactico}</div>
            <div class="stat-label">SintÃ¡cticos</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" style="color:var(--red)">${semantico}</div>
            <div class="stat-label">SemÃ¡nticos</div>
          </div>
        </div>
      </div>`;
        setBadge('badge-resultado', `${totalErrors} error${totalErrors !== 1 ? 'es' : ''}`, true);
        setStatus('error', `${totalErrors} error${totalErrors !== 1 ? 'es' : ''}`);
      }

      // â”€â”€ Errores tab â”€â”€
      const errorsList = document.getElementById('errors-list');
      const emptyErrors = document.getElementById('empty-errores');

      if (errors.length === 0) {
        emptyErrors.style.display = '';
        errorsList.style.display = 'none';
        setBadge('badge-errores', '0', false);
      } else {
        emptyErrors.style.display = 'none';
        errorsList.style.display = 'block';
        setBadge('badge-errores', String(errors.length), true);

        let errHtml = `<div class="error-summary" style="margin-bottom:8px">
      <span class="error-summary-icon">â›”</span>
      <div>
        <div class="error-summary-text">${errors.length} error${errors.length !== 1 ? 'es' : ''} de compilaciÃ³n</div>
        <div class="error-summary-sub">Haz clic en un error para saltar a la lÃ­nea</div>
      </div>
    </div>`;

        errors.forEach((err, i) => {
          const typeKey = err.type.includes('LÃ‰XICO') || err.type.includes('LEXICO') ? 'lex'
            : err.type.includes('SINT') ? 'syn'
              : err.type.includes('SEMÃ') || err.type.includes('SEMA') ? 'sem'
                : 'unk';
          const badgeClass = 'badge-' + typeKey;
          const cardClass = 'error-card ' + typeKey;
          const typeLabel = err.type.replace(/_/g, ' ');

          errHtml += `
        <div class="${cardClass}" style="animation-delay:${i * 40}ms"
             onclick="jumpToLine(${err.line})">
          <div class="error-top">
            <span class="error-type-badge ${badgeClass}">${typeLabel}</span>
            <span class="error-location">LÃ­nea ${err.line}, Col ${err.col}</span>
            ${err.token ? `<span class="error-token">${err.token}</span>` : ''}
          </div>
          <div class="error-msg">${err.msg || 'â€”'}</div>
        </div>`;
        });

        errorsList.innerHTML = errHtml;
      }

      // Auto-switch to errors tab if there are errors
      if (errors.length > 0 && activeTab === 'resultado') {
        // keep on resultado showing summary, user can click to errors
      }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  JUMP TO LINE
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function jumpToLine(lineNum) {
      if (!lineNum) return;
      const lines = textarea.value.split('\n');
      let pos = 0;
      for (let i = 0; i < Math.min(lineNum - 1, lines.length); i++) {
        pos += lines[i].length + 1;
      }
      textarea.focus();
      textarea.setSelectionRange(pos, pos + (lines[lineNum - 1] || '').length);
      // Scroll line into view
      const lineHeight = 22;
      textarea.scrollTop = Math.max(0, (lineNum - 5)) * lineHeight;
      switchTab('raw');
      setTimeout(() => switchTab('errores'), 50);
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  MAIN COMPILE
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function compilar() {
      const codigo = textarea.value.trim();
      if (!codigo) {
        setStatus('error', 'editor vacÃ­o');
        return;
      }

      const btn = document.getElementById('btn-run');
      btn.classList.add('loading');
      btn.innerHTML = '<span style="animation:pulse 1s infinite;display:inline-block">â³</span> Compilandoâ€¦';
      setStatus('running', 'compilandoâ€¦');

      try {
        const resp = await fetch(BACKEND_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'text/plain; charset=utf-8' },
          body: codigo,
          signal: AbortSignal.timeout(15000)
        });

        const text = await resp.text();
        renderResults(text);

      } catch (err) {
        const isNetwork = err.name === 'TypeError' || err.name === 'TimeoutError';
        if (isNetwork) {
          document.getElementById('conn-overlay').classList.add('show');
          setStatus('error', 'sin conexiÃ³n');
        } else {
          renderResults('âœ— Error al conectar con el backend:\n' + err.message);
          setStatus('error', 'error de red');
        }
      } finally {
        btn.classList.remove('loading');
        btn.innerHTML = '<span class="run-icon">â–¶</span> Compilar';
      }
    }

    function dismissOverlay() {
      document.getElementById('conn-overlay').classList.remove('show');
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //  SAMPLE CODE (pre-loaded)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    textarea.value = `inicio
  entero x = 10;
  entero y = 20;
  real resultado;

  resultado = x + y;
  escribir(resultado);

  si (x < y) entonces {
    escribir("x es menor");
  } sino {
    escribir("y es menor o igual");
  }
fin`;
    updateLineNumbers();
  </script>
</body>

</html>